<app-generic-page
  [title]="'Diagnostic Questions'"
  [loading]="loading()"
  [tabs]="tabs()"
  [activeTabKeyInput]="activeTab()"
  [searchQueryInput]="search()"
  [facets]="facets()"
  [columns]="columns()"
  [data]="data()"
  [total]="total()"
  [pageIndexInput]="pageIndex()"
  [pageSizeInput]="pageSize()"
  [searchPlaceholder]="searchPlaceholder()"
  [primaryAction]="primaryAction()"
  (primaryActionClick)="onPrimaryActionClick()"
  (pageChange)="onPageChange($event)"
  (filtersChange)="onFiltersChange($event)"
  (sortingChange)="onSortingChange($event)"
  (tabChange)="onTabChange($event)"
  (cellAction)="onCellAction($event)"
></app-generic-page>

<!-- Assignment Modal -->
<app-generic-modal
  [isOpen]="isAssignModalOpen()"
  [title]="'Assign Question Set to Tester'"
  [actions]="assignModalActions()"
  size="md"
  (close)="closeAssignModal()"
  (actionClick)="onAssignModalAction($event)"
>
  <div class="space-y-4">
    <!-- Display selected question set (read-only) -->
    <div class="form-control">
      <label class="label mb-1">
        <span class="label-text font-semibold">Question Set</span>
      </label>
      <div class="alert alert-info">
        <svg xmlns="http://www.w3.org/2000/svg" class="stroke-current shrink-0 h-5 w-5" fill="none" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
        </svg>
        <span class="font-medium">{{ getSelectedQuestionSetTitle() }}</span>
      </div>
    </div>

    <!-- Tester selection -->
    <div class="form-control">
      <label class="label mb-1">
        <span class="label-text">Select Tester <span class="text-error">*</span></span>
      </label>
      <select 
        class="select select-accent select-bordered w-full" 
        (change)="onTesterSelect($event)"
        [value]="selectedTesterId() ?? ''"
        [disabled]="loading()"
      >
        <option value="">Select a testerâ€¦</option>
        @for (opt of testerOptions(); track opt.value) {
          <option [value]="opt.value">{{ opt.label }}</option>
        }
      </select>
    </div>
  </div>
</app-generic-modal>

<!-- Delete Confirmation Modal -->
<app-generic-modal
  [isOpen]="isDeleteModalOpen()"
  [title]="'Confirm Deletion'"
  [actions]="deleteModalActions()"
  size="md"
  (close)="closeDeleteModal()"
  (actionClick)="onDeleteModalAction($event)"
>
  <div class="text-sm text-base-content/70">
    <p>Are you sure you want to delete this question set? This action cannot be undone.</p>
  </div>
</app-generic-modal>
