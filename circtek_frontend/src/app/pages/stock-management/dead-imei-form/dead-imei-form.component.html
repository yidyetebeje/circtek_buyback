<app-generic-form-page
  title="Add Dead IMEI Device"
  subtitle="Mark a device as dead IMEI and write it off from inventory"
  [form]="form"
  [fields]="formFields()"
  [loading]="loading()"
  [error]="error()"
  submitLabel="Save Dead IMEI Record"
  [submitDisabled]="!canSubmit()"
  (submit)="onSubmit()"
  (cancel)="onCancel()"
  (backClick)="onBackClick()">
  
  <!-- Custom content for device scanner and device info -->
  <div class="space-y-6">
    <!-- Device Scanner with Search Button -->
    <div class="form-group">
      <app-barcode-scanner
        placeholder="Scan or enter IMEI/Serial number..."
        label="Device Identifier"
        [required]="true"
        [showSearchButton]="true"
        searchButtonText="Search Device"
        [searching]="searching()"
        [autoClear]="false"
        (scanned)="onScan($event)"
        (searchClicked)="onSearchClick($event)"
        (inputChanged)="onInputChange($event)" />

      @if (error()) {
        <div class="label">
          <span class="label-text-alt text-error">{{ error() }}</span>
        </div>
      }
    </div>

    <!-- Device Information Display -->
    @if (deviceFound()) {
      <div class="alert alert-success">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6 stroke-current shrink-0">
          <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
        </svg>
        <div class="w-full">
          <div class="font-bold text-success-content mb-2">Device Found Successfully</div>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-3 text-sm text-success-content">
            <div class="flex justify-between">
              <span class="font-medium">Device ID:</span>
              <span class="font-mono">{{ deviceFound().id }}</span>
            </div>
            <div class="flex justify-between">
              <span class="font-medium">SKU:</span>
              <span class="font-mono">{{ deviceFound().sku }}</span>
            </div>
            @if (deviceFound().imei) {
              <div class="flex justify-between">
                <span class="font-medium">IMEI:</span>
                <span class="font-mono">{{ deviceFound().imei }}</span>
              </div>
            }
            @if (deviceFound().serial) {
              <div class="flex justify-between">
                <span class="font-medium">Serial:</span>
                <span class="font-mono">{{ deviceFound().serial }}</span>
              </div>
            }
            @if (deviceFound().warehouse_name) {
              <div class="flex justify-between">
                <span class="font-medium">Current Warehouse:</span>
                <span>{{ deviceFound().warehouse_name }}</span>
              </div>
            }
          </div>
          <div class="mt-3 pt-3 border-t border-success-content/20">
            <div class="flex items-center gap-2 text-sm">
              <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-4 h-4">
                <path stroke-linecap="round" stroke-linejoin="round" d="M11.25 11.25l.041-.02a.75.75 0 011.063.852l-.708 2.836a.75.75 0 001.063.853L15.75 12a.75.75 0 000-1.5l-3.75-3.75a.75.75 0 00-1.063 0z" />
              </svg>
              <span class="text-success-content/80">Ready to mark as dead IMEI. Click "Save Dead IMEI Record" to continue.</span>
            </div>
          </div>
        </div>
      </div>
    }
  </div>
</app-generic-form-page>
