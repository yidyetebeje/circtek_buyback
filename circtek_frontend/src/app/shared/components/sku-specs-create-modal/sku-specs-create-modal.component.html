<app-generic-modal
  [isOpen]="isOpen()"
  [title]="title()"
  [actions]="actions()"
  (actionClick)="onActionClick($event)"
  (close)="onClose()">
  
  <form [formGroup]="form()" class="space-y-6">
    @if (error()) {
      <div class="alert alert-error">
        <span>{{ error() }}</span>
      </div>
    }

    <!-- Basic Information -->
    <div class="form-section">
      <h3 class="section-title">Basic Information</h3>
      
      <div class="form-row">
        <div class="form-group">
          <label for="sku" class="label">
            <span class="label-text font-medium">SKU <span class="text-error">*</span></span>
          </label>
          <input
            id="sku"
            type="text"
            formControlName="sku"
            class="input input-bordered w-full placeholder:text-base-content/50 placeholder:font-normal"
            [class.input-error]="isFieldInvalid('sku')"
            placeholder="Enter SKU code (max 21 characters)"
            maxlength="21"
          />
          @if (isFieldInvalid('sku')) {
            <div class="label">
              <span class="label-text-alt text-error">{{ getFieldError('sku') }}</span>
            </div>
          } @else {
            <div class="label">
              <span class="label-text-alt text-base-content/60">Maximum 21 characters due to barcode limitations</span>
            </div>
          }
        </div>

        <div class="form-group">
          <label for="make" class="label">
            <span class="label-text font-medium">Make</span>
          </label>
          <input
            id="make"
            type="text"
            formControlName="make"
            class="input input-bordered w-full placeholder:text-base-content/50 placeholder:font-normal"
            [class.input-error]="isFieldInvalid('make')"
            placeholder="e.g., Apple, Samsung"
          />
          @if (isFieldInvalid('make')) {
            <div class="label">
              <span class="label-text-alt text-error">{{ getFieldError('make') }}</span>
            </div>
          }
        </div>
      </div>

      <div class="form-row">
        <div class="form-group">
          <label for="model_no" class="label">
            <span class="label-text font-medium">Model Number</span>
          </label>
          <input
            id="model_no"
            type="text"
            formControlName="model_no"
            class="input input-bordered w-full placeholder:text-base-content/50 placeholder:font-normal"
            [class.input-error]="isFieldInvalid('model_no')"
            placeholder="e.g., A2482, SM-G998B"
          />
          @if (isFieldInvalid('model_no')) {
            <div class="label">
              <span class="label-text-alt text-error">{{ getFieldError('model_no') }}</span>
            </div>
          }
        </div>

        <div class="form-group">
          <label for="model_name" class="label">
            <span class="label-text font-medium">Model Name</span>
          </label>
          <input
            id="model_name"
            type="text"
            formControlName="model_name"
            class="input input-bordered w-full placeholder:text-base-content/50 placeholder:font-normal"
            [class.input-error]="isFieldInvalid('model_name')"
            placeholder="e.g., iPhone 15 Pro, Galaxy S24 Ultra"
          />
          @if (isFieldInvalid('model_name')) {
            <div class="label">
              <span class="label-text-alt text-error">{{ getFieldError('model_name') }}</span>
            </div>
          }
        </div>
      </div>

      <div class="form-control">
        <label class="label cursor-pointer justify-start gap-3">
          <input
            type="checkbox"
            formControlName="is_part"
            class="checkbox checkbox-primary"
          />
          <span class="label-text">This is a part/component</span>
        </label>
        <div class="label">
          <span class="label-text-alt text-base-content/60">Check if this is a part rather than a complete device</span>
        </div>
      </div>
    </div>

    <!-- Device-Specific Information (only shown when is_part is false) -->
    @if (isDeviceFieldsSection()) {
      <div class="form-section">
        <h3 class="section-title">Device Specifications</h3>
        <p class="section-description">Optional fields for devices</p>
        
        <div class="form-row">
          <div class="form-group">
            <label for="device_type" class="label">
              <span class="label-text font-medium">Device Type</span>
            </label>
            <select
              id="device_type"
              formControlName="device_type"
              class="select select-accent w-full">
              <option value="">Select device type</option>
              <option value="iPhone">iPhone</option>
              <option value="Android">Android</option>
              <option value="Macbook">Macbook</option>
              <option value="Airpods">Airpods</option>
            </select>
          </div>

          <div class="form-group">
            <label for="storage" class="label">
              <span class="label-text font-medium">Storage</span>
            </label>
            <input
              id="storage"
              type="text"
              formControlName="storage"
              class="input input-bordered w-full placeholder:text-base-content/50 placeholder:font-normal"
              [class.input-error]="isFieldInvalid('storage')"
              placeholder="e.g., 128GB, 256GB"
            />
            @if (isFieldInvalid('storage')) {
              <div class="label">
                <span class="label-text-alt text-error">{{ getFieldError('storage') }}</span>
              </div>
            }
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label for="memory" class="label">
              <span class="label-text font-medium">Memory</span>
            </label>
            <input
              id="memory"
              type="text"
              formControlName="memory"
              class="input input-bordered w-full placeholder:text-base-content/50 placeholder:font-normal"
              [class.input-error]="isFieldInvalid('memory')"
              placeholder="e.g., 8GB, 12GB"
            />
            @if (isFieldInvalid('memory')) {
              <div class="label">
                <span class="label-text-alt text-error">{{ getFieldError('memory') }}</span>
              </div>
            }
          </div>

          <div class="form-group">
            <label for="color" class="label">
              <span class="label-text font-medium">Color</span>
            </label>
            <input
              id="color"
              type="text"
              formControlName="color"
              class="input input-bordered w-full placeholder:text-base-content/50 placeholder:font-normal"
              [class.input-error]="isFieldInvalid('color')"
              placeholder="e.g., Space Gray, Midnight Blue"
            />
            @if (isFieldInvalid('color')) {
              <div class="label">
                <span class="label-text-alt text-error">{{ getFieldError('color') }}</span>
              </div>
            }
          </div>
        </div>
      </div>
    }

    <!-- Status -->
    <div class="form-section">
      <div class="form-control">
        <label class="label cursor-pointer justify-start gap-3">
          <input
            type="checkbox"
            formControlName="status"
            class="checkbox checkbox-primary"
          />
          <span class="label-text">Active</span>
        </label>
        <div class="label">
          <span class="label-text-alt text-base-content/60">Uncheck to create as inactive</span>
        </div>
      </div>
    </div>
  </form>
</app-generic-modal>
